---
title: Configuring Rack Awareness in Kubernetes using the Helm Chart
---

<head>
    <meta name="title" content="Kubernetes Helm chart: rack awareness | Redpanda Docs"/>
    <meta name="description" content="Setting up rack awareness with the Kubernetes helm chart."/>
</head>


For more information about what Redpanda rack awareness is and why it's used, see [data-management/rack-awareness](./rack-awareness)

## Setting up rack awareness with the Redpanda Helm chart

By convention, the major cloud services annotate Kubernetes Nodes with the availability zone that the Node instance is placed in.
To use that annotation to inform Redpanda to use those zones for fault tolerance at the data level, apply values to enable the feature:

### Create a configuration file

Create a configuration file to enable rack awareness:

_rack_awareness.yaml_

```yaml
rackAwareness:
    enabled: true
serviceAccount:
    create: true
rbac:
    enabled: true
```

See the Helm chart's [values.yaml](https://github.com/redpanda-data/helm-charts/tree/main/charts/redpanda/values.yaml) for additional options to `rackAwareness`, `serviceAccount`, and `rbac`

The `rackAwareness` configuration uses the following default values:
- The [well-known](https://kubernetes.io/docs/reference/labels-annotations-taints/#topologykubernetesiozone) node annotation (`rackAwareness.nodeAnnotation`): `topology.kubernetes.io/zone`.
- The `redpanda.yaml` configuration flag is set to enable rack awareness.
- The `rack` configuration is set to the value of the node annotation.

The serviceAccount configuration allows the Helm chart to create a ServiceAccount.

The rbac configuration allows the Helm chart to create ClusterRoles and ClusterRoleBindings that allow the Redpanda initialization container to read the annotation from the Node.

### Install or Update your Helm release

Create a new Redpanda cluster or apply this change to an existing Redpanda cluster with Helm:

```sh
helm repo add redpanda https://charts.redpanda.com/
helm repo update
helm upgrade --install redpanda redpanda/redpanda redpanda \
  --namespace redpanda --create-namespace \
  --values rack_awareness.yaml
```

## Annotating nodes in non-cloud settings

The common convention for annotating Kubernetes Nodes is to use the `topology.kubernetes.io/zone` key. Label the nodes based on your own fault-tolerance requirements. Set this annotation by running:

```sh
kubectl annotate node dc1r12c22 topology.kubernetes.io/zone=dc1r12
```

In this example, dc1r12c22 is the node name for compute node 22 in rack 12 in datacenter 1. The annotation is set to dc1r12 so that any Redpanda pod that gets scheduled on that Node will have its `rack` setting configured to `dc1r12`.

If you already have an annotation model that you use, you can set the `rackAwareness.nodeAnnotation` to match your existing key.
