---
title: Configure TLS in Kubernetes
tags:
  - Kubernetes
  - Helm configuration
  - Security
---

<head>
    <meta name="title" content="Configure TLS in Kubernetes | Redpanda Docs"/>
    <meta name="description" content="Use TLS to authenticate the Redpanda brokers and encrypt communication between clients and brokers."/>
</head>

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

Redpanda supports Transport Layer Security (TLS) encryption in Kubernetes. TLS authenticates the Redpanda brokers and encrypts communication between clients and brokers. To configure TLS do the following:

1. [Install cert-manager](#install-cert-manager)
1. Configure the Helm chart to create a [self-signed certificate](#use-a-self-signed-certificate) or [use an existing custom Issuer](#use-a-custom-issuer)

## Prerequisites

You need the following:

-  A custom domain

- [External access](../../manage-kubernetes/networking-and-connectivity) to your Redpanda cluster. Your Redpanda broker should advertise an address in your custom domain.

## Install cert-manager

For TLS certificate management, the Redpanda Helm chart uses cert-manager.
cert-manager adds certificates and certificate issuers as resource types in Kubernetes clusters, and simplifies the process of obtaining, renewing and using those certificates. For details about cert-manager, see the [cert-manager documentation](https://cert-manager.io/docs/).

```bash
helm repo add jetstack https://charts.jetstack.io
helm repo update
helm install cert-manager jetstack/cert-manager \
  --set installCRDs=true \
  --namespace cert-manager \
  --create-namespace
```

## Use a self-signed certificate

1. Enable TLS.

  Replace the `<custom-domain` placeholder with your domain.

  <Tabs groupId="helm-config">
  <TabItem value="values" label="--values">

  ```yaml title="enable-tls.yaml"
  tls:
    enabled: true
  external:
    domain: <custom-domain>
  ```

  ```bash
  helm upgrade --install redpanda redpanda/redpanda -n redpanda --create-namespace \
    --values enable-tls.yaml
  ```

  </TabItem>
  <TabItem value="flags" label="--set">

  ```bash
  helm upgrade --install redpanda redpanda/redpanda -n redpanda --create-namespace \
    --set tls.enabled=true \
    --set external.domain=<custom-domain>
  ```

  </TabItem>
  </Tabs>

1. Test your local connection:

  ```bash
  kubectl exec redpanda-0 -n redpanda -c redpanda -- rpk cluster info --tls-enabled --brokers=redpanda-0.redpanda.redpanda.svc.cluster.local.:9093 --tls-truststore /etc/tls/certs/default/ca.crt
  ```

  <details>
  <summary>
  Example output
  </summary>
  
  ```
  CLUSTER
  =======
  redpanda.19ae8532-c8fa-49ed-8b35-82d74813db3a

  BROKERS
  =======
  ID    HOST                                             PORT
  0*    redpanda-0.redpanda.redpanda.svc.cluster.local.  9093
  1     redpanda-1.redpanda.redpanda.svc.cluster.local.  9093
  2     redpanda-2.redpanda.redpanda.svc.cluster.local.  9093
  ```
  
  </details>

1. Retrieve the root certificate authority (CA) to use with external clients:

  ```bash
  kubectl -n redpanda get secret redpanda-default-root-certificate -o go-template='{{ index .data "ca.crt" | base64decode }}' > ca.crt
  ```

1. Use that root CA to validate your external connection to Redpanda with rpk.

  Replace `<custom-domain>` with your domain. Replace `<external-port>` with the port on which your cluster is exposed.

  ```bash
  rpk cluster info --brokers <custom-domain>:<external-port> --tls-truststore ca.crt
  ```

## Use a custom Issuer

You can use your own Issuer or ClusterIssuer to take advantage of an ACME certificate provider such as Let's Encrypt or to use any other intermediate certificate authority (CA).

1. Create an Issuer in the same namespace as your Redpanda cluster, or create a ClusterIssuer. For details, see the [cert-manager documentation](https://cert-manager.io/docs/concepts/issuer/).

1. Configure the Helm chart to use your custom Issuer.

  Replace the following placeholders:

  - `<issuer-name>`: The name of your Issuer or ClusterIssuer resource
  - `<issuer>`: Issuer or ClusterIssuer
  - `<custom-domain`: Your domain

  <Tabs groupId="helm-config">
  <TabItem value="values" label="--values">

  ```yaml title="enable-tls.yaml"
  tls:
    enabled: true
    certs:
      default:
        issuerRef:
          name: <issuer-name>
          kind: <issuer>
  external:
    domain: <custom-domain>
  ```

  ```bash
  helm upgrade --install redpanda redpanda/redpanda -n redpanda --create-namespace \
    --values enable-tls.yaml
  ```

  </TabItem>
  <TabItem value="flags" label="--set">

  ```bash
  helm upgrade --install redpanda redpanda/redpanda -n redpanda --create-namespace \
    --set tls.enabled=true \
    --set tls.certs.default.issuerRef.name=<issuer-name>
    --set tls.certs.default.issuerRef.kind=<issuer>
    --set external.domain=<custom-domain>
  ```

  </TabItem>
  </Tabs>

1. Validate your external connection to Redpanda with rpk.

  Replace `<custom-domain>` with your domain. Replace `<external-port>` with the port on which your cluster is exposed.

  ```bash
  rpk cluster info --brokers <custom-domain>:<external-port>
  ```

## Next steps

Add client authentication by combining TLS encryption with [SASL authentication](../sasl-kubernetes).